function u_y = Dq(u,h,order)

    u_y = 0*u;
    [m,n] = size(u);
    if(order == 2)
        u_y(:,1) = u(:,2) - u(:,1);
        u_y(:,n) = u(:,n) - u(:,n-1);
        for i = 2:n-1
            u_y(:,i) = 0.5*(u(:,i+1) - u(:,i-1));
        end
    elseif(order == 4)   
        u_y(:,1) = -1.576527260783884*u(:,1) + 1.972775709802204*u(:,2) + 0.040836435296694*u(:,3) - 0.693890956864462*u(:,4)...
            + 0.256806072549449*u(:,5);

        u_y(:,2) = -0.451047142261160*u(:,1) + 0.185148101793909*u(:,3) + 0.455027117229871*u(:,4) - 0.210262828535670*u(:,5)...
            + 0.021134751773050*u(:,6);
        
        u_y(:,3) = -0.020427163198248*u(:,1) - 0.405074844833881*u(:,2) + 0.134720700985761*u(:,4) + 0.452993793355239*u(:,5)...
            - 0.162212486308872*u(:,6);
        
        u_y(:,4) = 0.179140757490107*u(:,1) - 0.513802524967025*u(:,2) - 0.069530808366309*u(:,3) + 0.368098737516488*u(:,5)...
            + 0.036093838326738*u(:,6);
        
        u_y(:,5) = -0.088216121348878*u(:,1) + 0.315908236179015*u(:,2) - 0.311081860348502*u(:,3) - 0.489783126488655*u(:,4)...
            + 0.663432368058167*u(:,6) - 0.090259496051147*u(:,7);
        
        u_y(:,6) = -0.029028856952944*u(:,2) + 0.101835934814000*u(:,3) - 0.043904283847899*u(:,4) - 0.606500263586147*u(:,5)...
            + 0.660111393797703*u(:,7) - 0.082513924224713*u(:,8);
        
        u_y(:,n-5) = 0.082513924224713*u(:,n-7) - 0.660111393797703*u(:,n-6) + 0.606500263586147*u(:,n-4) + 0.043904283847899*u(:,n-3)...
            - 0.101835934814000*u(:,n-2) + 0.029028856952944*u(:,n-1);
        
        u_y(:,n-4) = 0.090259496051147*u(:,n-6) - 0.663432368058167*u(:,n-5) + 0.489783126488655*u(:,n-3) + 0.311081860348502*u(:,n-2)...
            - 0.315908236179015*u(:,n-1) + 0.088216121348878*u(:,n);
        
        u_y(:,n-3) = - 0.036093838326738*u(:,n-5) - 0.368098737516488*u(:,n-4) + 0.069530808366309*u(:,n-2) + 0.513802524967025*u(:,n-1)...
            - 0.179140757490107*u(:,n);
        
        u_y(:,n-2) = 0.162212486308872*u(:,n-5) - 0.452993793355239*u(:,n-4) - 0.134720700985761*u(:,n-3) + 0.405074844833881*u(:,n-1)...
            + 0.020427163198248*u(:,n);
        
        u_y(:,n-1) = - 0.021134751773050*u(:,n-5) + 0.210262828535670*u(:,n-4) - 0.455027117229871*u(:,n-3) - 0.185148101793909*u(:,n-2)...
            + 0.451047142261160*u(:,n);
        
        u_y(:,n) = -0.256806072549449*u(:,n-4) + 0.693890956864462*u(:,n-3) - 0.040836435296694*u(:,n-2) - 1.972775709802204*u(:,n-1)...
            + 1.576527260783884*u(:,n);
 
        for i = 7:n-6
            u_y(:,i) = 0.083333333333333*u(:,i-2) - 0.666666666666667*u(:,i-1) + 0.666666666666667*u(:,i+1) - 0.083333333333333*u(:,i+2);
        end
    elseif(order == 6)
        u_y(:,1) = -1.694834962162858*u(:,1) + 2.245634824947698*u(:,2) - 0.055649692295628*u(:,3) - 0.670383570370653*u(:,4)...
            - 0.188774952148393*u(:,5) + 0.552135032829910*u(:,6) - 0.188126680800077*u(:,7);
        
        u_y(:,2) = -0.434411786832708*u(:,1) + 0.107043134706685*u(:,3) + 0.420172642668695*u(:,4) + 0.119957288069806*u(:,5)...
            - 0.328691543801578*u(:,6) + 0.122487487014485*u(:,7) - 0.006557221825386*u(:,8);
        
        u_y(:,3) = 0.063307644169533*u(:,1) - 0.629491308812471*u(:,2) + 0.809935419586724*u(:,4) - 0.699016381364484*u(:,5)...
            + 0.850345731199969*u(:,6) - 0.509589652965290*u(:,7) + 0.114508548186019*u(:,8);
        
        u_y(:,4) = 0.110198643174386*u(:,1) - 0.357041083340051*u(:,2) - 0.117033418681039*u(:,3) + 0.120870009174558*u(:,5)...
            + 0.349168902725368*u(:,6) - 0.104924741749615*u(:,7) - 0.001238311303608*u(:,8);
        
        u_y(:,5) = 0.133544619364965*u(:,1) - 0.438678347579289*u(:,2) + 0.434686341173840*u(:,3) - 0.520172867814934*u(:,4)...
            + 0.049912002176267*u(:,6) + 0.504693510958978*u(:,7) - 0.163985258279827*u(:,8);
        
        u_y(:,6) = -0.127754693486067*u(:,1) + 0.393149407857401*u(:,2) - 0.172955234680916*u(:,3) - 0.491489487857764*u(:,4)...
            - 0.016325050231672*u(:,5) + 0.428167552785852*u(:,7) - 0.025864364383975*u(:,8) + 0.013071869997141*u(:,9);
        
        u_y(:,7) = 0.060008241515128*u(:,1) - 0.201971348965594*u(:,2) + 0.142885356631256*u(:,3) + 0.203603636754774*u(:,4)...
            - 0.227565385120003*u(:,5) - 0.590259111130048*u(:,6) + 0.757462553894374*u(:,8) - 0.162184436527372*u(:,9)...
            + 0.018020492947486*u(:,10);
        
        u_y(:,8) = 0.009910488565285*u(:,2) - 0.029429452176588*u(:,3) + 0.002202493355677*u(:,4) + 0.067773581604826*u(:,5)...
            + 0.032681945726690*u(:,6) - 0.694285851935105*u(:,7) + 0.743286642396343*u(:,9) - 0.148657328479269*u(:,10)...
            + 0.016517480942141*u(:,11);
        
        u_y(:,n-7) =-0.016517480942141*u(:,n-10) + 0.148657328479269*u(:,n-9) - 0.743286642396343*u(:,n-8) + 0.694285851935105*u(:,n-6)...
            - 0.032681945726690*u(:,n-5) - 0.067773581604826*u(:,n-4) - 0.002202493355677*u(:,n-3) + 0.029429452176588*u(:,n-2)...
            - 0.009910488565285*u(:,n-1);
        
        u_y(:,n-6) =-0.018020492947486*u(:,n-9) + 0.162184436527372*u(:,n-8) - 0.757462553894374*u(:,n-7) + 0.590259111130048*u(:,n-5)...
            + 0.227565385120003*u(:,n-4) - 0.203603636754774*u(:,n-3) - 0.142885356631256*u(:,n-2) + 0.201971348965594*u(:,n-1)...
            - 0.060008241515128*u(:,n);
        
        u_y(:,n-5) =-0.013071869997141*u(:,n-8) + 0.025864364383975*u(:,n-7) - 0.428167552785852*u(:,n-6) + 0.016325050231672*u(:,n-4)...
            + 0.491489487857764*u(:,n-3) + 0.172955234680916*u(:,n-2) - 0.393149407857401*u(:,n-1) + 0.127754693486067*u(:,n);
        
        u_y(:,n-4) = 0.163985258279827*u(:,n-7) - 0.504693510958978*u(:,n-6) - 0.049912002176267*u(:,n-5) + 0.520172867814934*u(:,n-3)...
            - 0.434686341173840*u(:,n-2) + 0.438678347579289*u(:,n-1) - 0.133544619364965*u(:,n);
        
        u_y(:,n-3) = 0.001238311303608*u(:,n-7) + 0.104924741749615*u(:,n-6) - 0.349168902725368*u(:,n-5) - 0.120870009174558*u(:,n-4)...
            + 0.117033418681039*u(:,n-2) + 0.357041083340051*u(:,n-1) - 0.110198643174386*u(:,n);
        
        u_y(:,n-2) =-0.114508548186019*u(:,n-7) + 0.509589652965290*u(:,n-6) - 0.850345731199969*u(:,n-5) + 0.699016381364484*u(:,n-4)...
            - 0.809935419586724*u(:,n-3) + 0.629491308812471*u(:,n-1) - 0.063307644169533*u(:,n);
        
        u_y(:,n-1) = 0.006557221825386*u(:,n-7) - 0.122487487014485*u(:,n-6) + 0.328691543801578*u(:,n-5) - 0.119957288069806*u(:,n-4)...
            - 0.420172642668695*u(:,n-3) - 0.107043134706685*u(:,n-2) + 0.434411786832708*u(:,n);
        
        u_y(:,n)   = 0.188126680800077*u(:,n-6) - 0.552135032829910*u(:,n-5) + 0.188774952148393*u(:,n-4) + 0.670383570370653*u(:,n-3)...
            + 0.055649692295628*u(:,n-2) - 2.245634824947698*u(:,n-1) + 1.694834962162858*u(:,n);
        
        for i = 9:n-8
            u_y(:,i) = -0.016666666666667*u(:,i-3) + 0.15*u(:,i-2) - 0.75*u(:,i-1) + 0.75*u(:,i+1) - 0.15*u(:,i+2) + 0.016666666666667*u(:,i+3);
        end
    end
    u_y = (1/h)*u_y;
end